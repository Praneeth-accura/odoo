<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
	    <record id="report_xlsx_wizard_form" model="ir.ui.view">
	        <field name="name">report.xlsx.wizard.form</field>
	        <field name="model">report.xlsx.wizard</field>
	        <field name="arch" type="xml">
		        <form>
		        	<field name="is_printed" nolabel="1" readonly="1" invisible="1"/>
		            <group attrs="{'invisible': [('is_printed','=',True)]}">
		                <group>
		                    <field name="report_type" widget="selection"/>
		                    <field name="date_from" attrs="{'invisible': [('report_type','not in',['etf','epf','etf2'])]}"/>
		                    <field name="date_to" attrs="{'invisible': [('report_type','not in',['etf','epf','etf2'])]}"/>
		                </group>
		            </group>
		            <group attrs="{'invisible': [('is_printed','!=',True)]}">
		            	<field widget="binary" name="report_file" nolabel="1" filename="report_name"/>
	                    <field name="report_name" nolabel="1" readonly="1" invisible="1"/>
		            </group>
		            <footer>
		                <button name="print_xlsx_reports" string="Export" icon="fa-print" type="object" class="oe_highlight" attrs="{'invisible': [('is_printed','=',True)]}"/>
		                <button name="action_back" string="Back" class="btn btn-default" type='object' attrs="{'invisible': [('is_printed','!=',True)]}"></button>
		                <button string="Cancel" class="oe_link" special="cancel" />
		            </footer>
		        </form>
	        </field>
	    </record>
	    <record id="action_view_xlsx_report_wizard" model="ir.actions.act_window">
	            <field name="name">Reports</field>
	            <field name="type">ir.actions.act_window</field>
	            <field name="res_model">report.xlsx.wizard</field>
	            <field name="view_type">form</field>
	            <field name="view_mode">form</field>
	            <field name="view_id" ref="report_xlsx_wizard_form"/>
	            <field name="target">new</field>
	    </record>
	    
	    <menuitem
	        	action="action_view_xlsx_report_wizard"
	            id="menu_xlsx_report"
	            name="Reports"
	            parent="hr_payroll.menu_hr_payroll_root"
	            sequence="30"
	            groups ="hr_payroll.group_hr_payroll_manager"
	    />
	</data>
	
</odoo>
