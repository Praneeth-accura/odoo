<?xml version="1.0" encoding="utf-8"?>
<odoo>
<template id="report_salary_payslip">
    <t t-call="web.html_container">
        <t t-foreach="docs" t-as="o">
            <t t-call="web.external_layout">
                <div class="page">
<!--                 	<p class="text-right"> -->
<!--                 		<span t-esc="context_timestamp(datetime.datetime.now()).strftime('%Y-%m-%d %H:%M')"/>  -->
<!--                 	</p> -->
<!--                 	<br/> -->
                    <h4 class="text-center"><strong t-field="o.name"/></h4>
<!-- 					<br/> -->
<!-- 					<div style="float:left;"> -->
<!-- 		            	<div class="col-sm-12" style="float:left"> -->
				            <table class="table table-bordered">
			            		<tr style="height: 25px;">
			            			<td><span>Employee Code&#160;</span> </td>
<!-- 			            			<td colspan="2"><b>&#160;:&#160;</b></td> -->
			            			<td><strong t-field="o.employee_id.employee_code"/></td>
			            			<td>EPF No&#160;</td>
<!-- 			            			<td><b>&#160;:&#160;</b></td> -->
			            			<td><strong t-field="o.employee_id.contract_id.member_no"/></td>
			            		</tr>
			            		<tr style="height: 25px;">
			            			<td>Employee Name&#160;</td>
<!-- 			            			<td colspan="2"><b>&#160;:&#160;</b></td> -->
			            			<td><strong t-field="o.employee_id.name"/></td>
			            			<td>Designation&#160;</td>
<!-- 			            			<td><b>&#160;:&#160;</b></td> -->
			            			<td><strong t-field="o.employee_id.job_id.name"/></td>
			            		</tr>
				        	</table>
<!-- 				        </div> -->
<!-- 			       	</div> -->
<!-- 					<div style="clear:both"> -->
<!-- 			        	<br/> -->
<!-- 			        </div> -->
                    <table class="table table-bordered">
                        <tbody>
                        	<t t-set="gross" t-value="0"/>
                        	<t t-set="net" t-value="0"/>
                        	<t t-set="epf1" t-value="0"/>
                        	<t t-set="epf2" t-value="0"/>
                        	<t t-set="etf" t-value="0"/>
                        	<t t-set="ptax" t-value="0"/>
                        	<tr t-foreach="get_details_by_rule_category.get(o.id, [])" t-as="h">
                        		<t t-if="h['code'] not in ['EPF','ETF','EPTF','PFS']">
                        			<t t-if="h['level'] == 0">
			                       		<t t-if="h['code'] == 'NET'">
		                       				<t t-set="net" t-value="net + h['total']"/>
		                       			</t>
		                       			<t t-if="h['code'] == 'GROSS'">
		                        				<t t-set="gross" t-value="gross + h['total']"/>
		                        		</t>
<!-- 		                        		<t t-if="h['code'] == 'EPTF'"> -->
<!--                         					<td> -->
<!-- 	                                   			<span t-esc="'&#160;&#160;&#160;&#160;'*h['level']"/> -->
<!-- 	                                   			<span style="font-weight: bold;">PF Salary</span> -->
<!-- 		                                	</td> -->
<!-- 		                                	<td><span style="color: white;" t-esc="'..'"/></td> -->
<!--                         				</t> -->
<!--                         				<t t-else="else"> -->
                        				<t t-if="h['code'] not in ['EPTF','PFS']">
                        					<td>
	                                   			<span t-esc="'&#160;&#160;&#160;&#160;'*h['level']"/>
	                                   			<span t-esc="h['rule_category']" style="font-weight: bold;"/>
		                                	</td>
		                                	<td class="text-right" style="border-bottom: 1px solid black;">
			                                   <span t-esc="h['total']" style="font-weight: bold;"
			                                         t-esc-options='{"widget": "monetary", "display_currency": o.company_id.currency_id}'/>
			                               </td>
                        				</t>
	                       			</t>
	                       			<t t-else="else">
	                       				<t t-if="h['code'] == 'PF'">
                        					<t t-set="epf1" t-value="epf1 + h['total']"/>
			                       		</t>
			                       		<t t-if="h['code'] == 'PAYE'">
			                       			<t t-set="ptax" t-value="ptax + h['total']"/>
			                       		</t>
	                                	<td>
	                                    	<span t-esc="'&#160;&#160;&#160;&#160;'*h['level']"/><span t-esc="h['rule_category']"/>
	                                	</td>
	                                	<td class="text-right">
		                                    <span t-esc="h['total']"
		                                          t-esc-options='{"widget": "monetary", "display_currency": o.company_id.currency_id}'/>
		                                </td>
	                                </t>
                        		</t>
                        		<t t-else="else">
                        			<t t-if="h['code'] == 'EPF'">
		                       			<t t-set="epf2" t-value="epf2 + h['total']"/>
		                       		</t>
		                       		<t t-if="h['code'] == 'ETF'">
		                       			<t t-set="etf" t-value="etf + h['total']"/>
		                       		</t>
                        		</t>
                            </tr>
                        </tbody>
                    </table>
<!-- 					<br/> -->
					<table class="table table-bordered">
                        <tr>
                            <td><strong>EPF Comp. Cont.</strong></td>
                            <td><span t-esc="epf2" t-esc-options='{"widget": "monetary", 
	                        														  "display_currency": o.company_id.currency_id}'/>
           					</td>
           					<td><strong>ETF</strong></td>
                            <td><span t-esc="etf" t-esc-options='{"widget": "monetary", 
	                        														  "display_currency": o.company_id.currency_id}'/></td>
                            <td><span style="color: white;" t-esc="'..'"/></td>
                            <td><span style="color: white;" t-esc="'..'"/></td>
                        </tr>
                        <tr>
                            <td><strong>Bank</strong></td>
                            <td><span t-field="o.employee_id.bank"/></td>
                            <td><strong>Branch</strong></td>
                            <td><span t-field="o.employee_id.branch"/></td>
                            <td><strong>A/C. No.</strong></td>
                            <td><span t-field="o.employee_id.bank_account_id.acc_number"/></td>
                        </tr>
                    </table>
                	<table class="table table-bordered">
                        <tr>
                            <td><strong>YTD Gross Salary</strong></td>
                            <td><span t-esc="o.find_sum_of_ytd(o.id,'GROSS')" t-esc-options='{"widget": "monetary", 
	                        														  "display_currency": o.company_id.currency_id}'/></td>
                            <td><strong>YTD EPF EMP. Cont.</strong></td>
                            <td><span t-esc="o.find_sum_of_ytd(o.id,'PF')" t-esc-options='{"widget": "monetary", 
	                        														  "display_currency": o.company_id.currency_id}'/></td>
              				<td><strong>YTD PAYE Tax</strong></td> 
                        	<td><span t-esc="o.find_sum_of_ytd(o.id,'PAYE')" t-esc-options='{"widget": "monetary", 
	                        														  "display_currency": o.company_id.currency_id}'/></td>
                        </tr>
                        <tr>
                            <td><strong>YTD Net Salary</strong></td>
                            <td><span t-esc="o.find_sum_of_ytd(o.id,'NET')" t-esc-options='{"widget": "monetary", 
	                        														  "display_currency": o.company_id.currency_id}'/></td>
                            <td><strong>YTD EPF Comp. Cont.</strong></td>
                            <td><span t-esc="o.find_sum_of_ytd(o.id,'EPF')" t-esc-options='{"widget": "monetary", 
	                        														  "display_currency": o.company_id.currency_id}'/></td>
	                        <td><strong>YTD ETF</strong></td>
                            <td><span t-esc="o.find_sum_of_ytd(o.id,'ETF')" t-esc-options='{"widget": "monetary", 
	                        														  "display_currency": o.company_id.currency_id}'/></td>
                        </tr>
                    </table>
                    <p class="text-right"><strong>This is a computer generated salary slip, no signature required.</strong></p>
                </div>
            </t>
        </t>
    </t>
</template>
</odoo>
